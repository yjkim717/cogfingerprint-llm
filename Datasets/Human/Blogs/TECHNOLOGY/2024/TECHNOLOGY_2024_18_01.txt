Year: 2024
Author: kbbtech
URL: https://www.reddit.com/r/sysadmin/comments/1cagbow/bat_file_download_file_with_yesterdays_date/

Hi all I'm new to scripting and find myself tasked with downloading a file via WinSCP. I've figured out how to automate that using a bat file that starts the WinSCP program and points it to a text file. I've figured out how to set the data variable and all works great if the file being downloaded had the current date. The issue I now face is the file I need to download contains yesterday's date. I based the scripting off this article: Advanced Batch File Programming: YESTERDAY.BAT | Experts Exchange (experts-exchange.com) I'm using the following code in my bat file, but it still comes back with today's date. Note: I didn't use set /a because the file name will contain zeros for numbers less than 10. *set DD=%date:\~7,2%* *set MM=%date:\~4,2%* *set YYYY=%date:\~10,4%* *:loop* ***set DD-=1*** *if %DD% lss 1 (* *set DD=31* *set MM-=1* *if %MM% lss 1 (* *set MM=12* *set YYYY-=1* *)* *)* *Start "" "Location to program" /script="location to scrip.txt"* The script.txt contains the commands to connect, where to download the file from and where to download it to. It seems like it is skipping the bolded section ***set DD-=1*** *(or probably the entire loop section)* Any idea's on what I might be missing? Thanks in advance.
