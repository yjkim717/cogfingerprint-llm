Year: 2023
Author: Wobblycogs
URL: https://www.reddit.com/r/homelab/comments/15r28jn/mounting_and_swapping_usb_drives_for_backup_is/

I'm in the process of designing a backup system for my home lab and I'm not sure I'm going down the correct path. The plan is to use Restic to backup to removable USB drives cycling through three (swapping once a week) with one always living in a Peli case somewhere outside the house. I want to make this as simple and idiot proof as possible so I actually do the backups. What I've been trying to do today is have all the backup drives listed in `/etc/fstab` and all pointing at the same mount point (`/media/backup`). My thinking was that I could attach one drive and run `mount -a` and as if by magic the current backup device would appear. The reality hasn't gone quite so well. I wanted to find out what would happen if I inadvertently had two drives attached when I ran a mount all. It worked, which I wasn't surprised by, but it feels like an accident waiting to happen. It also confused the hell out of KDE Discover. I also had to us the `nofail` option in `/etc/fstab` to prevent warnings about missing devices. What's the correct way to achieve what I want? I'm currently thinking I'll write a little script that I can get to unmount all backup devices and then mount the ones I tell it are connected. It's a bit more manual intervention than I wanted but I'm pretty sure it'll work.
