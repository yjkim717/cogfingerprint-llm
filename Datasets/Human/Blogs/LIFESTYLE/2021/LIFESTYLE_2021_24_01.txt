Year: 2021
Author: R1ch0C
URL: https://www.reddit.com/r/PowerShell/comments/q60hwf/help_with_web_scraping/

Hi All, Hopefully this will be a simple one for you as I'm confident that I'm just making a mistake/unable to find the correct way to do this. (I've not done much web scraping before) I'm using powershell to try and scrape the address of every Nationwide branch location. To do so, i'm using this link: All Nationwide branches | Current account, Mortgage, Savings As you can see, that site has a page for each area, with the actual address on the next page when you follow the link. Inspecting the page, I can see that in the class "Directory-listLink" the href value contains the second part of each pages link (i.e. "aberdare/60-cardiff-street"). My plan was to scrape all these links and then go through each one to finally pull the address from each individual page. However - I've started struggling right away! The script I have so far is: &#x200B; $w = Invoke-WebRequest -Uri $firstBit = " $myArray = $w.AllElements | where class -EQ "Directory-listLink" | select href For ($i=0; $i -lt $myArray.Length; $i++) { $firstBit + $myArray[$i] } &#x200B; The problem I'm having is that My result of $firstBit + $myArray\[$i\] isn't Like I hoped, instead it's So it looks like i'm copying some info that I don't want to be but i'm really struggling to figure out how to get rid of it. Feel free to call me stupid and tell me just how wrong all this is! Appreciate any help :)
